<html>
	<head>
    	<link rel="stylesheet" href="style.css" media="all" />
    	<script type="text/javascript" src="navigation.json"></script>
		<script language="Javascript">

var navigation = {
    "derp":"derp",
    "children":
    [
        {
            "divId":"shirt",
            "iconFile":"shirt.jpg",
            "imageCaption":"Shirt",
            "actionName":"View Shirts",
            "children":
            [
                {
                    "filename":"shirt/shirt.jpg",
                    "iconFile":"shirt/shirt.jpg",
                    "imageCaption":"Fireman Shirt",
                    "actionName":"Wear Fireman Shirt"
                },
                {
                    "filename":"shirt/labcoat.jpg",
                    "iconFile":"shirt/labcoat.jpg",
                    "imageCaption":"Lab Coat",
                    "actionName":"Wear Lab Coat"
                },
                {
                    "filename":"shirt/shirt3.jpg",
                    "iconFile":"shirt/shirt3.jpg",
                    "imageCaption":"Jersey",
                    "actionName":"Wear Jersey"
             	},
                {
                    "filename":"shirt/shirt4.jpg",
                    "iconFile":"shirt/shirt4.jpg",
                    "imageCaption":"Raincoat",
                    "actionName":"Wear Raincoat"
                },
                {
                    "filename":"shirt/shirt4.jpg",
                    "iconFile":"shirt/shirt4.jpg",
                    "imageCaption":"Sweater",
                    "actionName":"Wear Sweater"
                },
                {
                    "filename":"shirt/shirt4.jpg",
                    "iconFile":"shirt/shirt4.jpg",
                    "imageCaption":"Tee Shirt",
                    "actionName":"Wear Tee Shirt"
                },
                {
                    "filename":"shirt/shirt4.jpg",
                    "iconFile":"shirt/shirt4.jpg",
                    "imageCaption":"Pajamas",
                    "actionName":"Wear Pajamas"
                },
                {
                    "filename":"shirt/shirt4.jpg",
                    "iconFile":"shirt/shirt4.jpg",
                    "imageCaption":"Hoodie",
                    "actionName":"Wear Hoodie"
                }

            ]
        },
        {
            "divId":"pants",
            "iconFile":"pants.jpg",
            "imageCaption":"Pants",
            "actionName":"View Pants",
            "children":
            [
            
                {
                    "filename":"pants/pants.jpg",
                    "iconFile":"pants/pants.jpg",
                    "imageCaption":"Jeans",
                    "actionName":"Wear Jeans"
                },
                {
                    "filename":"pants/pants2.jpg",
                    "iconFile":"pants/pants2.jpg",
                    "imageCaption":"Shorts",
                    "actionName":"Wear Shorts"
                },
                {
                    "filename":"pants/pants3.jpg",
                    "iconFile":"pants/pants3.jpg",
                    "imageCaption":"Yoga Pants",
                    "actionName":"Wear Yoga Pants"
                },
                {
                    "filename":"pants/scrubs.jpg",
                    "iconFile":"pants/scrubs.jpg",
                    "imageCaption":"Scrubs",
                    "actionName":"Wear Scrubs"
                },
                {
                    "filename":"pants/pants4.jpg",
                    "iconFile":"pants/pants4.jpg",
                    "imageCaption":"Skirt",
                    "actionName":"Wear Skirt"
                },
                {
                    "filename":"pants/pants4.jpg",
                    "iconFile":"pants/pants4.jpg",
                    "imageCaption":"Pajamas",
                    "actionName":"Wear Pajamas"
                },
                {
                    "filename":"pants/pants4.jpg",
                    "iconFile":"pants/pants4.jpg",
                    "imageCaption":"Fireman Pants",
                    "actionName":"Wear Fireman Pants"
                },
                {
                    "filename":"pants/pants4.jpg",
                    "iconFile":"pants/pants4.jpg",
                    "imageCaption":"Kilt",
                    "actionName":"Wear Kilt"
                }            
            ]
        },
        {
            "divId":"shoes",
            "iconFile":"shoes.jpg",
            "imageCaption":"Shoes",
            "actionName":"View Shoes",
            "children":
            [
            
                {
                    "filename":"shoes/shoes.jpg",
                    "iconFile":"shoes/shoes.jpg",
                    "imageCaption":"shoes",
                    "actionName":"Wear shoes"
                }
			]
        },
        {
            "iconFile":"jacket.jpg",
            "imageCaption":"Jackets",
            "actionName":"View Jackets",
            "children":
            [
            
                {
                    "filename":"jacket/jacket",
                    "iconFile":"jacket/jacket",
                    "imageCaption":"jacket",
                    "actionName":"Wear jacket"
                }
			]
        },
        {
            "divId":"hat",
            "iconFile":"hat.jpg",
            "imageCaption":"Hats",
            "actionName":"View Hats",
            "children":
            [
            
                {
                    "filename":"hat/hat.jpg",
                    "iconFile":"hat/hat.jpg",
                    "imageCaption":"Sun Hat",
                    "actionName":"Wear Sun Hat"
                },
                {
                    "filename":"hat/hat2.jpg",
                    "iconFile":"hat/hat2.jpg",
                    "imageCaption":"Red Hat",
                    "actionName":"Wear Red Hat"
                }
			]
        },
        {
            "divId":"accessories",
            "iconFile":"accessories.jpg",
            "imageCaption":"Accessories",
            "actionName":"View Accessories",
            "children":
            [
            
                {
                    "filename":"accessories/accessories.jpg",
                    "iconFile":"accessories/accessories.jpg",
                    "imageCaption":"Scarf",
                    "actionName":"Wear Scarf"
                },
                {
                    "filename":"face/face.jpg",
                    "iconFile":"face/face.jpg",
                    "imageCaption":"face",
                    "actionName":"Wear Face"
                }
			]

        },
        /*{
            "divId":"backgrounds",
            "iconFile":"backgrounds.jpg",
            "imageCaption":"Backgrounds",
            "actionName":"View Backgrounds",
            "children":
            [
            
                {
                    "filename":"backgrounds/backgrounds.jpg",
                    "iconFile":"backgrounds/backgrounds.jpg",
                    "imageCaption":"backgrounds",
                    "actionName":"Wear backgrounds"
                }
			]
        },*/
        {
            "divId":"body",
            "iconFile":"body/body-1-icon.png",
            "imageCaption":"Body",
            "actionName":"View Bodies",
            "children":
            [
            
                {
                    "filename":"body/body-1.png",
                    "iconFile":"body/body-1-icon.png",
                    "imageCaption":"Pale Body",
                    "actionName":"Wear Pale Body"
                },
                {
                    "filename":"body/body-2.png",
                    "iconFile":"body/body-2-icon.png",
                    "imageCaption":"Dark Body",
                    "actionName":"Wear Dark Body"
                },
                {
                    "filename":"body/body-3.png",
                    "iconFile":"body/body-3-icon.png",
                    "imageCaption":"Pink Body",
                    "actionName":"Wear Pink Body"
                },
                {
                    "filename":"body/body-4.png",
                    "iconFile":"body/body-4-icon.png",
                    "imageCaption":"Yellow Body",
                    "actionName":"Wear Yellow Body"
                },
                {
                    "filename":"body/body-5.png",
                    "iconFile":"body/body-5-icon.png",
                    "imageCaption":"Blue Body",
                    "actionName":"Wear Blue Body"
                },
                {
                    "filename":"body/body-6.png",
                    "iconFile":"body/body-6-icon.png",
                    "imageCaption":"Green Body",
                    "actionName":"Wear Green Body"
                },
                {
                    "filename":"body/body-7.png",
                    "iconFile":"body/body-7-icon.png",
                    "imageCaption":"Purple Body",
                    "actionName":"Wear Purple Body"
                } 
            ]
        },
        {
            "divId":"hair",
            "iconFile":"hair/hair-1-icon.png",
            "imageCaption":"Hair",
            "actionName":"View Hair Options",
            "children":
            [
            
                {
                    "filename":"hair/hair-1.png",
                    "iconFile":"hair/hair-1-icon.png",
                    "imageCaption":"Blonde Bob",
                    "actionName":"Wear Blonde Bob"
                },
                {
                    "filename":"hair/hair-2.png",
                    "iconFile":"hair/hair-2-icon.png",
                    "imageCaption":"Black Pigtails",
                    "actionName":"Wear Black Pigtails"
                },
                {
                    "filename":"hair/hair-3.png",
                    "iconFile":"hair/hair-3-icon.png",
                    "imageCaption":"hair1",
                    "actionName":"Wear hair1"
                },
                {
                    "filename":"hair/hair-4.png",
                    "iconFile":"hair/hair-4-icon.png",
                    "imageCaption":"hair1",
                    "actionName":"Wear hair1"
                },
                {
                    "filename":"hair/hair-5.png",
                    "iconFile":"hair/hair-5-icon.png",
                    "imageCaption":"hair1",
                    "actionName":"Wear hair1"
                },
                {
                    "filename":"hair/hair-6.png",
                    "iconFile":"hair/hair-6-icon.png",
                    "imageCaption":"hair1",
                    "actionName":"Wear hair1"
                },                                
			]
        },
        {
            "divId":"settings",
            "iconFile":"settings.jpg",
            "imageCaption":"Settings",
            "actionName":"Change Settings",
            "children":
            [
            
                {
                    "filename":"settings/clock.jpg",
                    "imageCaption":"Timer",
                    "actionName":"Change Timer",
                    "children":
                    [
                    	{
                    		"time":700,
                 		   "filename":"settings/clock.jpg",
                 		   "imageCaption":"small",
                 		   "actionName":"S"
                    	},
                    	{
                    		"time":1000,
                 		   "filename":"settings/clock.jpg",
                 		   "imageCaption":"medium",
                 		   "actionName":"M"
                    	},
                    	{
                    		"time":1500,
                 		   "filename":"settings/clock.jpg",
                 		   "imageCaption":"long",
                 		   "actionName":"long"
                    	}
                    ]
                },
                {
                    "filename":"settings/puzzle.jpg",
                    "imageCaption":"Game Mode",
                    "actionName":"Change game Mode",
                    "children":
                    [
                    	{
                 		   "filename":"settings/puzzle.jpg",
                 		   "imageCaption":"Freeplay",
                 		   "actionName":"Use Freeplay Mode"
                    	},
                    	{
                    		"time":1000,
                 		   "filename":"settings/puzzle.jpg",
                 		   "imageCaption":"Challenge",
                 		   "actionName":"Use Challenge Mode"
                    	}
                    	
                    ]
                }
            ]
        }
    ]
}

var challenges = {
    "derp":"derp",
    "children":
    [
        {
            "challengePrompt":"Dress Max like a Doctor",
            "positiveFeedback":"Perfect!",
            "negativeFeedback":"Is this what a Doctor would wear?",
            "children":
                {
                    "shirt":[1,4],
                    "pants":[3]
                }
        },
        {
            "challengePrompt":"Dress Max like a Fireman",
            "positiveFeedback":"Get at me fires!",
            "negativeFeedback":"Is this what a Fireman would wear?",
            "children":
                {
                    "hat":[1]
                }
        },
        {
            "challengePrompt":"Wear a scarf! its cold yo",
            "positiveFeedback":"Yay so warm now!",
            "negativeFeedback":"Hurry I'm freezing to death!!!",
            "children":
                {
                    "accessories":[0]
                }
        }

    ]
}
        //Settings Variables
        var clickMode = true;  //dominate: if true, twoswitch boolean essentially false
        var twoSwitch = false;
        var timeIntreval = 400;
        var challengeMode = false;

        //Navigation Variables
		var currentLevel = 0;
		var highlightedItem = 0;
		var currentParent = navigation;
		var settings = navigation.children[8];
		var timer = settings.children[0];

        //Challenge Variables
        var firstChallenge = false;
        var challengeComplete = false;
        var promptOpen = false;
        var currentClothes = {};
        var challengeIterator = 0;
        var numberOfChallenges = challenges.children.length;
        var currentChallenge = challenges.children[challengeIterator];
        var challengeGoodFeedback = currentChallenge.positiveFeedback;
        var challengeBadFeedback = currentChallenge.negativeFeedback;

		function loadScreen() {
			clearScreen();
            if(clickMode == true){
                document.getElementById("actionBar").style.visibility="hidden";
            }else {
                document.getElementById("actionBar").style.visibility="visible";
            }
		
            if(challengeMode == true){
                document.getElementById("item9").style.visibility="visible";
                if(challengeComplete == false){
                    document.getElementById("item9").innerHTML = currentChallenge["challengePrompt"];
                }else{
                    document.getElementById("item9").innerHTML = "Next Challenge";
                }
                if(firstChallenge == false){
                    showPrompt(currentChallenge.challengePrompt);
                    firstChallenge = true;
                }
            }

			//Fill in grid with appropriate items
			for (var j = 0; j < currentParent.children.length; j++) { 
				var label = "item" + j;
			    document.getElementById(label).innerHTML = "<img src='images/" + currentParent.children[j].iconFile + "' height='80px'><br/ >" + currentParent.children[j].imageCaption;
			}
			
			//Add back button
			if(currentLevel > 0){
				label = "item" + currentParent.children.length;
				document.getElementById(label).innerHTML = "<img src='images/home.jpg'><br/ >Back";
			}
			
		}

        function showThought(text) {
            document.getElementById("thoughts").innerHTML = text;
            document.getElementById("thoughts").style.visibility="visible";
            window.setTimeout(function(){hideDiv("thoughts")},1000)
        }

        function hideDiv(parameter) {
            document.getElementById(parameter).style.visibility="hidden";
            if(parameter == "settings"){
                loadScreen();
            }else if(parameter == "prompt"){
                promptOpen = false;
                loadScreen();
            }
        }

        function showPrompt(text) {
            promptOpen = true;
            for (var j = 0; j < 10; j++) { 
                var label = "item" + j;
                document.getElementById(label).className = "unSelected";
            }
            if(clickMode == false){
                document.getElementById("promptButton").className = "selected";
            }
            document.getElementById("promptText").innerHTML = text;
            document.getElementById("prompt").style.visibility="visible";
        }

        window.setInterval(function(){
            if(twoSwitch == false && clickMode == false && promptOpen == false){
                iterate();
            }
        }, timeIntreval);

		function iterate(){
		
			//unselect previous
			document.getElementById("item" + highlightedItem).className = "unSelected";

			//increment which item we're currently selecting
			highlightedItem = highlightedItem+1;
			maxLength = currentParent.children.length;
			
			if(currentLevel > 0){  //add one for back button if not homescreen
				maxLength = maxLength +1;  
			}else {
                if(challengeComplete==true){maxLength++;}
            }
			
			//end of loop, begin at zero
			if(highlightedItem == maxLength){
				highlightedItem = 0;
			}
			
			//add action name
			if(currentLevel > 0 && highlightedItem == currentParent.children.length){
				document.getElementById("actionText").innerHTML = "Go back";
			}else if(currentLevel == 0 && highlightedItem == 9){
                document.getElementById("actionText").innerHTML = "Next Challenge";
            } else{
				document.getElementById("actionText").innerHTML = currentParent.children[highlightedItem].actionName;
			}
			
			//highlight current selection 
			document.getElementById("item" + highlightedItem).className = "selected";

		}
		
		window.addEventListener("keydown", dealWithKeyboard, false);

        function proceedToNextChallenge() {
            challengeIterator = challengeIterator + 1;
            if(numberOfChallenges <= challengeIterator){
                showPrompt("All challenges completed! Refresh page to play again.");
            }
            currentChallenge = challenges.children[challengeIterator];
            challengeGoodFeedback = currentChallenge.positiveFeedback;
            challengeBadFeedback = currentChallenge.negativeFeedback;
            challengeComplete = false;
        
        }

        function dealWithKeyboard(e){
            //alert(e.keyCode);
            if(clickMode == false){
                if(promptOpen == true){
                    hideDiv('prompt');
                }else {
                    if(e.keyCode==13 || twoSwitch == false){
                        selectionMade(highlightedItem);
                    }else {
                        iterate();
                    }
                }
            }
        }

        function itemClick(i){
            if(clickMode == true){
                if(i == "prompt"){
                    hideDiv("prompt");
                }else {
                    selectionMade(i);
                }
            }
        }

		function selectionMade(selectedItem) {
            if(selectedItem == 9){ //Next Challenge
                proceedToNextChallenge();
                loadScreen();
                showPrompt(currentChallenge.challengePrompt);
            }
			else if(currentLevel == 0){
				currentLevel = 1;
				currentParent = navigation.children[selectedItem];
				loadScreen();
			}else if (currentLevel == 1) {
				if(selectedItem == currentParent.children.length){ //going back a level
					currentLevel = 0;
					currentParent = navigation;
					loadScreen();
				}else if(currentParent == settings){ //going forward a level within settings
					currentLevel = 2;
					currentParent = settings.children[selectedItem];
					loadScreen();
				}else{  //add clothing item to screen
					url = "images/"+ currentParent.children[selectedItem].filename;
					document.getElementById(currentParent.divId).src=url;
                    currentClothes[currentParent.divId] = selectedItem;

                    if(challengeMode==true & challengeComplete==false){
                        giveChallengeFeedback(selectedItem);
                    }
				}
			}else { //NOTE: level 2 currently implies settings is parent
				if(highlightedItem == currentParent.children.length){ //going back a level
					currentLevel = 1;
					currentParent = settings;
					loadScreen();
				}else {
					//do seomthing to change settings
					if(currentParent == timer){
						timeIntreval = timer.children[selectedItem].time;
						
					}
				}
			}
		}	

        function giveChallengeFeedback(selectedItem){
            if (typeof currentChallenge.children[currentParent.divId] != 'undefined') {

                var message = challengeBadFeedback;
                var acceptableItems = currentChallenge.children[currentParent.divId];
                var isAcceptable = (acceptableItems.indexOf(selectedItem) > -1);

                if(isAcceptable){
                    message = challengeGoodFeedback;
                }
                showThought(message);

            }

            if(checkChallengeStatus() == true){
                challengeComplete = true;
                currentLevel = 0;
                currentParent = navigation;
                loadScreen();
                document.getElementById("item9").innerHTML = "Next Challenge";
            }
        }

        function checkChallengeStatus(){
            var complete = true;
            var index;
            var output = '', // initialise as string
                val;

            //If any of the required items is not current worn, it cannot be complete
            for (val in currentChallenge.children) {
                if (currentChallenge.children.hasOwnProperty(val)) {
                    output += "" + val + " : " + currentChallenge.children[val];
                    var acceptableItems = currentChallenge.children[val];
                    var isAcceptable = (acceptableItems.indexOf(currentClothes[val]) > -1);
                    if(!isAcceptable){
                        complete = false;
                    }
                    output += isAcceptable + "\n";
                }
            }
            //alert(output);

            return complete;
        }
		
		function clearScreen(){ //Resets grid to a clean slate
			for (var j = 0; j < 10; j++) { 
				var label = "item" + j;
			    document.getElementById(label).innerHTML = "";
				document.getElementById(label).className = "unSelected";
			}
            if(clickMode == false){
    			highlightedItem = 0;
    			document.getElementById("item0").className = "selected";
    			document.getElementById("actionText").innerHTML = currentParent.children[0].actionName;
		    }
        }

        function interactionMode(parameter){
            document.getElementById("interaction0").className = "unSelected";
            document.getElementById("interaction1").className = "unSelected";
            document.getElementById("interaction2").className = "unSelected";

            if(parameter == "twoswitch" ){
                twoSwitch = true;
                clickMode = false;
                document.getElementById("interaction2").className = "selected";
            }else if(parameter == "oneswitch" ){
                twoSwitch = false;
                clickMode = false;
                document.getElementById("interaction1").className = "selected";
            }else if(parameter = "click"){
                clickMode = true;
                document.getElementById("interaction0").className = "selected";
            }
        }
        function gameMode(parameter){
            document.getElementById("gameMode0").className = "unSelected";
            document.getElementById("gameMode1").className = "unSelected";

            if(parameter == "freeplay" ){
                challengeMode = false;
                document.getElementById("gameMode0").className = "selected";
            }else if(parameter == "challenge" ){
                challengeMode = true;
                document.getElementById("gameMode1").className = "selected";
            }
        }

		</script>
	</head>
	<body onload="loadScreen()">
		<div id="wrapper">
            <div id ="settings">
                <h1>Dress to the Max</h1><br />

                <h2>Settings</h2><br />

                <h3>Interaction Style</h3>
                <button class="selected" id="interaction0" onclick="interactionMode('click')">Click</button>
                <button onclick="interactionMode('oneswitch')" id="interaction1" >One Switch</button>
                <button onclick="interactionMode('twoswitch')"id="interaction2" >Two Switch</button><br /><br />
                <h3>Challenge vs Freeplay</h3>
                <button class="selected" onclick="gameMode('freeplay')" id="gameMode0">Freeplay</button>
                <button onclick="gameMode('challenge')" id="gameMode1" >Challenge</button><br /><br />
                <h3>Play Game</h3>
                <button onclick="hideDiv('settings')">Done</button>
            </div>
			<h1>Dress to the Max</h1>
            <div id ="prompt">
                <span id="promptText"></span>
                <ul>
                    <li id="promptButton" onclick="itemClick('prompt')">OK
                    </li>
                </ul>
            </div>
            <div id="leftSide">
               <div id ="thoughts">
                </div>
    			<div id="character">
                    <img id="body" src="images/body/body-1.png">
    				<img id="hat" >
    				<img id="accessories" >
    				<img id="shirt" >
    				<img id="jacket"  >
    				<img id="pants"  >
    				<img id="shoes" >
    				<img id="backgrounds" >
    				<img id="hair"  >
    			</div>
            </div>
			<div id="navigation">
                <div id="actionBar">
				    Action: <span id ="actionText">asdf</span>
                </div>
				<ul onkeydown="keypress1(event);" id="navlist">
					<li id="item0" onclick="itemClick(0)"></li>
                    <li id="item1" onclick="itemClick(1)"></li>
                    <li id="item2" onclick="itemClick(2)"></li>
                    <li id="item3" onclick="itemClick(3)"></li>
                    <li id="item4" onclick="itemClick(4)"></li>
                    <li id="item5" onclick="itemClick(5)"></li>
                    <li id="item6" onclick="itemClick(6)"></li>
                    <li id="item7" onclick="itemClick(7)"></li>
                    <li id="item8" onclick="itemClick(8)"></li>
                    <li id="item9" onclick="itemClick(9)"></li>
				</ul>
			</div>
		</div>
		<p class="footer">
		UNC Chapel Hill, Maegan Clawges, Krista Katzenmeyer, Jon Medenblik.  <a href="https://github.com/kkatzen/dress-to-the-max">Github</a>
		</p>
	</body>
</html>